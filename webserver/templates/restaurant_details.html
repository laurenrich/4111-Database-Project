{% extends "base.html" %}

{% block content %}
  <p><a href="/restaurants">‚Üê Back to Restaurants</a></p>
  
  <h1>{{ restaurant.name }}</h1>
  <p><strong>Address:</strong> {{ restaurant.address }}</p>
  
  <h2>Cuisines</h2>
  {% if cuisines|length == 0 %}
    <p>No cuisines assigned.</p>
  {% else %}
    <table>
      <tr>
        <th>Name</th>
        <th>Actions</th>
      </tr>
      {% for c in cuisines %}
      <tr>
        <td>{{ c.name }}</td>
        <td><a href="/cuisines">View Details</a></td>
      </tr>
      {% endfor %}
    </table>
  {% endif %}
  
  <h2>Dishes ({{ dishes|length }})</h2>
  {% if dishes|length == 0 %}
    <p>No dishes available.</p>
  {% else %}
    <table>
      <tr>
        <th>Name</th>
        <th>Ingredients</th>
        <th>Price</th>
        <th>Actions</th>
      </tr>
      {% for d in dishes %}
      <tr>
        <td>{{ d.name }}</td>
        <td>
          {% if d.ingredients %}
            {{ d.ingredients }}
          {% else %}
            <span style="color: #999;">No ingredients listed</span>
          {% endif %}
        </td>
        <td>
          {% if d.price %}
            ${{ "%.2f"|format(d.price) }}
          {% else %}
            <span style="color: #999;">Not set</span>
          {% endif %}
        </td>
        <td>
          <a href="/dishes">View Details</a>
          <a href="/dishes/{{ d.id }}/edit">Edit</a>
          <form method="POST" action="/dishes/{{ d.id }}/delete" style="display:inline;">
            <button type="submit" onclick="return confirm('Delete this dish?')">Delete</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </table>
  {% endif %}
  
  <h2>Reviews ({{ reviews|length }})</h2>
  {% if reviews|length == 0 %}
    <p>No reviews yet.</p>
  {% else %}
    <table>
      <tr>
        <th>User</th>
        <th>Rating</th>
        <th>Review</th>
        <th>Actions</th>
      </tr>
      {% for r in reviews %}
      <tr>
        <td>{{ r.user_name }}</td>
        <td>{{ r.rating }}</td>
        <td>{{ r.text }}</td>
        <td>
          <a href="/reviews">View Details</a>
          <form method="POST" action="/reviews/{{ r.id }}/delete" style="display:inline;">
            <button type="submit" onclick="return confirm('Delete this review?')">Delete</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </table>
  {% endif %}
  
  <h2>Orders ({{ orders|length }})</h2>
  {% if orders|length == 0 %}
    <p>No orders yet.</p>
  {% else %}
    <table>
      <tr>
        <th>Order ID</th>
        <th>User ID</th>
        <th>Date</th>
        <th>Total Amount</th>
        <th>Actions</th>
      </tr>
      {% for o in orders %}
      <tr>
        <td>{{ o.id }}</td>
        <td>{{ o.user_id }}</td>
        <td>{{ o.date }}</td>
        <td>{{ o.total }}</td>
        <td><a href="/orders/{{ o.id }}">View Details</a></td>
      </tr>
      {% endfor %}
    </table>
  {% endif %}
  
  <p><a href="/restaurants/{{ restaurant.id }}/add-review">Add Review</a> | 
     <a href="/restaurants/{{ restaurant.id }}/add-dish">Add Dish</a> | 
     <a href="/restaurants/{{ restaurant.id }}/add-order">Create Order</a></p>
  
  <form method="POST" action="/restaurants/{{ restaurant.id }}/delete" style="margin-top: 20px;">
    <button type="submit" onclick="return confirm('Delete this restaurant? This will also delete all associated dishes, reviews, and orders.')" style="background-color: #dc3545; color: white;">Delete Restaurant</button>
  </form>
{% endblock %}

